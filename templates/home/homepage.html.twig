{% extends 'base.html.twig' %}

{% block headTag %}

  <meta name="description" content="Plateforme de pr√©sentation de projets pr√©vus ou en cours. Trouvez de l'aide. Apportez votre aide. Pr√©sentez gratuitement votre projet, recherchez des projets.">

  <meta name="keywords" content="pr√©sentation de projets, entraide">

  {{ _self.openGraph('Ici on Pr√©sente nos Projets', 'Propon', app.request.uri, 'Pr√©sentez votre projet simplement, rendez-le plus visible, trouvez des contributeurs.', 'website', app.request.uri ~'public/media/static/images/propon_logo.svg') }}

{% endblock %}

{% block title %}Propon - La Plateforme de Pr√©sentation de Projets{% endblock %}

{% block stylesheets %}
  <link href="/css/titled_projects_collection.css" rel="stylesheet">
  <link href="/css/show_more_less_button.css" rel="stylesheet">

  {% if is_granted('ROLE_USER') %}

    <link href="/css/create_news.css" rel="stylesheet">

  {% endif %}

{% endblock %}

{% block javascripts %}<script src="/js/show_more_less_button.js"></script>
{% endblock %}

{% import "utilities/_macro_titled_collection.html.twig" as display %}
{% import "utilities/_macro_highlight_one_project.html.twig" as highlight %}
{% import "utilities/_macro_articles_cards.html.twig" as artCards %}

{% block body %}

  <div class="page-container container-lg px-0 col-xxl-12">

    {# Case user logged in : displaying personalized content #}


    {% if app.user %}

      <h4 class="text-center fs-4 mb-2 mb-md-4">üëã Bienvenue Parmi Nous</h4>

      <div class="row mb-2 mb-md-3 mb-lg-5">


        {# Presented projects #}

        <div class="connected-user-struct-container col-md-6 p-0 pe-md-3 ps-md-2 mb-2 mb-md-0">

          <div class="sm-border-none border rounded p-3 pb-1 h-100">
              
            <h5 class="d-flex align-items-center justify-content-center justify-content-md-start ps-md-3 mb-3"><img class="me-1 " src="{{ asset('goal.svg', 'misc')}}" alt="A target" height="19">Mes Projets Pr√©sent√©s</h5>

            <style>

              .connected-user-struct-container .list-group{


                max-height: 230px;
                overflow-y: auto;
        
              }
            

            </style>

            {% set userCreatedPresentations = app.user.createdPresentations | reverse %}

            {% if userCreatedPresentations | length  == 0 %}

              <div class="no-project-container">

                <p class="">

                  Pour <b>pr√©senter un projet</b>, <b>trouver de l'aide</b>,<br> et <b>donner des nouvelles</b>, <a href="{{path ('create_presentation')}}" title="this links targets to create a project presentation page."> <span class="fw-bold" >c'est ici üëà</span></a>
                  
                </p>

              </div>

              <style>

                /* When authenticated user has not created any presentation */

                .no-project-container {
                  width: 100%;
                  min-height: 170px;
                  padding: 25px 50px 25px 50px;
                  border-radius: 4px;
                }

                .no-project-container p {
                  margin-bottom: 0;
                  text-align: center;
                }
                
                @media screen and (max-width: 580px) {
                        
                  .no-project-container {
                    min-height: unset;
                    padding: 15px;
                    padding-bottom: 20px;
                    margin-bottom: 30px;
                  }
                    
                  .no-project-container p {
                    text-align: left;
                    font-size: 1.05rem;
                  }
                }
          
              </style>
              
            {% else %}
                
              <div class="list-group ps-md-3 mt-2 mb-3">

                {% for createdPresentation in userCreatedPresentations %}

                  <a href="#" class="list-group-item list-group-item-action">

                    <div class="d-flex w-100 justify-content-between">

                      <h5 class="mb-1">{{createdPresentation.title}}</h5>
          
                      <small>
                        {% if createdPresentation.updatedAt is not empty %}
                        
                            {{createdPresentation.updatedAt | formattedElapsedTime }}

                        {% else %}

                            {{createdPresentation.createdAt | formattedElapsedTime }}
                            
                        {% endif %}
            
                      </small>

                    </div>

                    <p class="mb-1">{{ createdPresentation.goal | length < 81 ? createdPresentation.goal[:1] | upper ~ createdPresentation.goal[1:] : createdPresentation.goal[:1] | upper ~ createdPresentation.goal[1:77] ~ '...' }}</p>

                    <small class="d-inline-block me-2">
                    
                      <div class="stats ">
                      
                          <span class="stat-chunk">

                              <img class="" src="{{ asset('thumb_up_dark.svg', 'misc')}}" alt="a thumb-up icon">

                              {{createdPresentation.likes | length }}
                          
                          </span>

                          <span class="stat-chunk">

                              <img class="" src="{{ asset('comment.svg', 'misc')}}" alt="a comment icon">

                              {{createdPresentation.comments | length }}
                          
                          </span>

                          <span class="stat-chunk">

                              <img class="" src="{{ asset('eye.svg', 'misc')}}" alt="an eye icon">

                              {{createdPresentation.getDataItem('viewsCount')}}
                          
                          </span>
                          
                      </div>
                      
                    </small>

                    <div class="d-inline-block"><input class="proxy-news-input me-0" type="text" placeholder="Partager des nouvelles">

                    <div class="fake-send-button d-inline-flex ms-1"><img class="text-success" src="{{ asset('send_message.svg', 'misc')}}" alt="paper plane icon"></div>
                        
                    </div>

                  </a>

                {% endfor %}

              </div>

            {% endif %}

          </div>

        </div>

        {# Created articles #}

        <div class="connected-user-struct-container col-md-6 p-0">

            <div class="sm-border-none border rounded p-3 pb-4 h-100">

                <h5 class="d-flex align-items-center justify-content-center justify-content-md-start mb-3 ps-3"><img class="me-1 " src="{{ asset('article.svg', 'misc')}}" alt="Article Icon" height="22"> Mes articles</h5>
                
                {% set userArticles = app.user.articles %}

                {% if userArticles | length == 0 %}

                  <div class="d-flex flex-column align-items-center justify-content-center">
                  
                    <div class="text-center mx-3 mt-2 fs-6 mb-3">
                    
                      <div class="mb-2">Vous avez des <b>conseils</b>, une <b>exp√©rience</b> ou une <b>actualit√©</b> √† partager ?</div>
                      <div class=""><b>Partagez vos connaissances avec notre super communaut√©.</b></div>
                    
                    </div>

                    <a href="{{ path ('edit_article') }}"><button type="button" class="btn btn-outline-primary d-flex align-items-center"><div class="flip-horiz me-2 mb-2">‚úçÔ∏è</div><div class=""> √âcrire un Article sur Propon</div></button></a>
                  
                  </div>

                {% else %}

                  <div class="list-group ps-md-3 mt-2 mb-3">

                    {% for article in userArticles %}

                        <div class="list-group-item list-group-item-action">

                          <a href="{{path('show_article', {"slug": article.slug})}}" class="text-body" aria-current="true">

                            <h5 class="d-inline mb-1 fs-6">{{article.title}}</h5>
                            
                          </a>

                        <a href="{{path('edit_article', {"id": article.id})}}" class="ms-3">Modifier</a>
                          
                        {# Stats #}
                                      
                          <span class="stat-chunk ms-3">

                              <img class="" src="{{ asset('eye.svg', 'misc')}}" alt="an eye icon">
                              {{article.getDataItem('viewsCount')}}
                              
                          </span> 

                        </div>
                        
                      

                    {% endfor %}
                
                  </div> 

                  <div class="ps-3"><a href="{{ path ('edit_article') }}"><button type="button" class="btn btn-outline-primary d-flex align-items-center py-0"><div class="flip-horiz me-2 mb-2">‚úçÔ∏è</div><div class=""> √âcrire un Article sur Propon</div></button></a></div>

                {% endif %}

            </div>

        </div>

      </div>
    
    {% endif %}

    {# Case user not logged in : displaying homepage jumbotron #}

    {% if not app.user %}

      <div id="homepage-jumbotron-struct-container" class="container col-xxl-11 px-0 px-md-4 px-lg-4">

        {% include "home/_jumbotron.html.twig" %}

        <style>

          @media screen and (min-width: 820px) {

            #homepage-jumbotron-struct-container{
              margin-top: 3rem;
              margin-bottom: 6rem;
              
            }
            
          }

        </style>

      </div>

    {% endif %}

    {# basic pool alert display 
    {% include "home/_basic_pool_alert.html.twig" %}#}


    {# Four highlighted projects
    <div class="">
        <h2 class="h3 text-center fw-bold mb-5" style="color:rgb(72, 67, 61)"> <span class="" style="display: inline-block;transform: matrix(-1, 0, 0, 1, 0, 0);"> üëá</span> D√©couvertes üëá</h2>
        <div class="row g-2" style="margin-left: -40px; margin-right: -40px;">
          {% for presentation in halfHighlightedProjects %}
              
            <div class="col-6 mb-2">
              {{ highlight.highlight (presentation) }}
            
            </div>
          {% endfor %}
        
        </div>
    </div> #}



    
    {# They trust us presentations #}

    <div>

      {{ render(path('get_picked_elements', {pickType: "trustUs", label: 'Ils Nous Font Confiance', iconName: 'heart'} )) }}

    </div>

    {# Picked Cool Project of the Day #}

    <div>

      {{render(path('get_picked_elements', {pickType: "projectOfTheDay"} )) }}

    </div>

    <div>
    
     {#  {% include "home/_projects_by_categories_tabs.html.twig" %} #}
      
    </div>

    {# Rational Argument Slider #}

    <div class="pb-3 pb-lg-4 mb-4 mb-lg-5">{% include "home/_arguments_slider.html.twig" %}</div>


    {# Create a presentation form 

    {% set createPresentationForm = form.createView %}

    <div class="container col border p-2 p-md-4 py-3 py-md-4 text-center mt-md-4 mb-4">

      <div class="col-12 col-md-8 mx-auto">
      
          {{form_start(createPresentationForm)}}

          <div class="fw-bold fs-2 mb-2">‚è±Ô∏è Pr√™t √† battre un record de vitesse ?</div>

          <div class="mb-3">{{form_label(createPresentationForm.goal)}}</div>
                            
          {{ form_errors(createPresentationForm.goal) }}
              
            {{form_widget(createPresentationForm.goal)}}

            <button id="" type="submit" class="create-presentation-button btn btn-validate btn-lg">Go üöÄ</button>

          {{ form_end(createPresentationForm) }}

      
      </div>

      <style>

        #create_presentation_goal{
          display: inline;
          width: 70%;
          height: 47px;
          margin-right: 20px;
        }
        .create-presentation-button{
          margin-bottom: 4px;
        }
                
        @media screen and (max-width: 580px) {
          #create_presentation_goal{
            width: 68%;
            margin-right: 5px;
          }
            
          .create-presentation-button{
            padding: 8px 9px;
            margin-bottom: 4px;
          }
        }
      
      </style>

    </div>#}


    {# Highlight a random project
    <div class="d-md-none">
    
      {{ highlight.highlight (highlightedProjects[0]) }}
    </div> #}
        
    {# Highlight a random project
    <div class="d-md-none">
    
      {{ highlight.highlight (highlightedProjects[1]) }}
      
    </div> #}
{# 
    <div class="dont-waste-time border p-3 mb-5"><p class="mb-0">‚åö Ne perdez pas votre temps ni celui des autres : r√©sumez votre projet et partagez son adresse personnalis√©e gratuite.</p></div>

 #}
    <style>
      
      @media screen and (min-width: 820px) {
          .dont-waste-time{
              text-align: center;
              font-size: 23px;
          } 
      }
    
    </style>

    {# How it works + FAQ #}
    
    {% include "home/_hiw_faq.html.twig" %}


    {# Create a presentation form
    {% set createPresentationForm2 = form.createView %}

    <div class="container col border p-2 p-md-4 py-3 py-md-3 text-center mt-3 mt-md-4 mb-4">

      <div class="col-12 col-md-8 mx-auto">
      
          {{form_start(createPresentationForm2)}}

          <div class="fw-bold fs-2 mb-2">üß≠ Pr√™t √† tester la simplicit√© ?</div>

          <div class="mb-3">{{form_label(createPresentationForm2.goal)}}</div>
                            
          {{ form_errors(createPresentationForm2.goal) }}
              
            {{form_widget(createPresentationForm2.goal)}}

            <button id="" type="submit" class="create-presentation-button btn btn-validate btn-lg">Go üöÄ</button>

          {{ form_end(createPresentationForm2) }}

      
      </div>

    </div>

     #}

    
    {# Highlight a random project
    <div class="d-md-none">
    
      {{ highlight.highlight (highlightedProjects[2]) }}
      
    </div> #}

    {# {% set createPresentationFormModal = form.createView %}

    Highlight a random project
    <div class="d-md-none">
    
      {{ highlight.highlight (highlightedProjects[3]) }}
      
    </div> #}

    
    {# Create a presentation form

    {% set createPresentationForm3 = form.createView %}

    <div class="container col border p-2 p-md-4 py-3 py-md-4 text-center mt-3 mt-md-4 mb-4">

      <div class="col-12 col-md-8 mx-auto">
      
          {{form_start(createPresentationForm3)}}

          <div class="fw-bold fs-2 mb-2">üëÅÔ∏è Gagnez en visibilit√©</div>

          <div class="mb-3">{{form_label(createPresentationForm3.goal)}}</div>
                            
          {{ form_errors(createPresentationForm3.goal) }}
              
            {{form_widget(createPresentationForm3.goal)}}

            <button id="" type="submit" class="create-presentation-button btn btn-validate btn-lg">Go üöÄ</button>

          {{ form_end(createPresentationForm3) }}

      
      </div>

    </div>

     #}



    {# Styled container to Access Geosearch

    {% include "home/_access_geosearch_jumbotron.html.twig" %} #}

  

    {# Quote on mobiles #}
    
    <div class="projects-change-the-world border mb-5 text-center fw-bold container col-lg-9">
    
      <p class="mb-0 mt-2">‚ú® Les projets changent le monde<br>Faites conna√Ætre le v√¥tre ‚òÑÔ∏è</p>

      {% set createPresentationForm4 = form.createView %}
    
      <div class="mb-4">

        {{form_start(createPresentationForm4)}}

          <div class="mb-1 mb-lg-3">{{form_label(createPresentationForm4.goal)}}</div>
                            
          {{ form_errors(createPresentationForm4.goal) }}
              
            {{form_widget(createPresentationForm4.goal)}}

            <button id="" type="submit" class="create-presentation-button btn btn-validate btn-lg">Go üöÄ</button>

          {{ form_end(createPresentationForm4) }}

      </div>
    
    </div>

    
    <style>

      #create_presentation_goal {
        display: inline;
        width: 70%;
        height: 47px;
        margin-right: 20px;
      }
      
      .projects-change-the-world{
          padding: 14px;
          text-align: center;
          font-size: 21px;

          margin-top: 90px;
      } 
  
      @media screen and (max-width: 580px) {

        #create_presentation_goal {
          width: 68%;
          margin-right: 5px;
        }

        .projects-change-the-world{
            padding: 10px 5px;
            text-align: left;
            font-size: 15px;
            margin-top: 24px;
        } 

          
      }
    
    </style>



    {# Propon Articles #}

    <div class="container my-5">

      <h4 class="d-flex align-items-center justify-content-center fw-bold mb-4"><img class="me-1 " src="{{ asset('article.svg', 'misc')}}" alt="Article Icon" height="25">Articles</h4>

      <div class="article-cards-container row row-cols-1 row-cols-md-3 g-4">

        {% for article in articles %}
          {{ artCards.articleCards (article) }}
        {% endfor %}
    
      </div>

      <style>

        @media screen and (max-width: 580px) {
        
          .article-cards-container {
            display: flex;
            flex-wrap: nowrap;
            overflow-x: auto;
          }

        }

      </style>

    </div>

    


    {# Highlight a random project #} 

    {{ highlight.highlight (highlightedProjects[0]) }}



{# Some arguments #}
{# Style Citation : Thanks @ https://codepen.io/chris22smith/pen/oQWavL #}
{#   <div class="d-none d-md-flex justify-content-center container col-7 mt-lg-5">

      <div class="quote">

        <blockquote>

          <p>Votre page qui concentre <u>l'essentiel</u>.<br>Votre projet <span class="circle-sketch-highlight">compr√©hensible</span> .<br>‚ö° (rapidement) </p>

          <cite>Propon</cite>

        </blockquote>

      </div>
  </div>

  <style>

    .quote {
      display: inline-block;
      margin: 1em;
      overflow: hidden;
    }
    .quote blockquote {
      background-color: #fff;
      border: solid 6px #5aa65a;
      display: inline-block;
      margin: 0;
      padding: 1em;
      position: relative;
    }
    .quote blockquote p {
      margin-bottom: -16px;
    }
    .quote blockquote:before {
      background-color: #fff;
      bottom: -10%;
      content: "";
      left: 0;
      position: absolute;
      right: 0;
      top: -10%;
      transform: rotate(-15deg) skew(5deg);
    }
    .quote blockquote cite {
      display: block;
      font-style: italic;
      text-align: right;
    }
    .quote blockquote cite:before {
      content: "- ";
    }
    .quote blockquote > * {
      position: relative;
      z-index: 1;
    }

    .circle-sketch-highlight{ /* Thanks at https://codepen.io/alvarotrigo/pen/dyJbjMX */
      position: relative;
      left: 0.5em;
    }

    .circle-sketch-highlight::before {
      content: "";
      z-index: -1;
      left: -0.5em;
      top: -0.1em;
      border-width: 4px;
      border-style: solid;
      border-color: #ff8400;
      position: absolute;
      border-right-color: transparent;
      width: 129%;
      height: 1.6em;
      transform: rotate(-1deg);
      opacity: 0.9;
      border-radius: 49%;
      padding: 0.1em 0em;
    }

    .circle-sketch-highlight::after {
      content: "";
      z-index: -1;
      left: 1.35em;
      top: 0.025em;
      padding: 0.19em 0.2em;
      border-width: 4px;
      border-style: solid;
      border-color: orange;
      border-left-color: transparent;
      border-top-color: transparent;
      position: absolute;
      width: 100%;
      height: 1em;
      transform: rotate(-1deg);
      opacity: 0.7;
      border-radius: 50%;
    }

  </style>
 #}

    

    {# some presentations by categories intersection
    {{ render(path('backend_search', {label: 'Projets personnalis√©s', filters: '(categories.uniqueName:material AND categories.uniqueName:environment)'})) }} #}
    
    
    {# > md screens : Search Bar container

    <div class="container col-xxl-11 mb-3">
      
      {% include "home/_search_container.html.twig" %}

    </div> #}

{#     {% include "home/_quote_with_create_presentation_form.html.twig" %}
 #}
  

    {# last project presentation #}
      
    {{ display.collection("üïë Derniers projets pr√©sent√©s", lastInsertedPresentations, "", "hide-335") }}



    {# Quote #}

    <div class="d-flex justify-content-center">

      <div class="quote d-flex container col-xxl-10 align-items-center rounded fw-bold text-center p-3 px-2 border mt-0 mt-md-2 mb-4 mb-md-5">
      
        <div class="img-col col-3">

          <img class="img-fluid" width="140" src="{{asset ('misc/plant.png', 'larger')}}" loading="lazy">
        
        </div>

        <div class="text-col col-9">
        
          <span class="" style="color: #a6711e">Les Projets </span> <span class="" style="color: green">de toutes tailles </span><br class="d-md-none"><span style="color: #a6711e">sont les briques pour </span><br class=""> <span class="" style="color: green">r√©aliser les plus grands projets.</span>
        
        </div>
      
      </div>
  </div>

    <style>

      .quote{

        font-size: 24px;

      }

      @media screen and (max-width: 820px){

        .quote{

          font-size: 16px;
          margin: 0;

        }

      }
    
    
    </style>


    {# Last call to action : Add a Project button #}

      {% include "home/_last_cta.html.twig" %}

    

</div> {# closes an unknow div which mess up footer display #}



  <style>

    .fs-2{
      font-size: 23px !important;
    }

    @media screen and (max-width: 820px){

      .fs-2{
        font-size: 18px !important;
      }

    }
  
  </style>


{% endblock %}
