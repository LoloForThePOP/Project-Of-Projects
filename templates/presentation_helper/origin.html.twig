{% extends 'base.html.twig' %}

{% block title %}Aide √† la pr√©sentation de projet{% endblock %}


{# "priorQuestion" is a prior question user can answer with yes or no, so that a form appears or not with an actual Question (questionFr) 
    "finalRenderingLabel" is the label that will be integrated on consultation page, if relevant.
#}

{% set helperItems = [ 
                    
    { 'uniqueName': "title", 'type': "title", 'priorQuestion': "‚úíÔ∏è Votre Projet a t-il d√©j√† un titre ou un titre temporaire ?", 'questionFr': "Quel est le titre du Projet ?",'finalRenderingLabel': ""}, 
        
    { 'uniqueName': "goal_details", 'type': "textDescription", 'priorQuestion': "üéØ Pouvez-vous d√©crire le r√©sultat final que vous aimeriez atteindre ?", 'questionFr': "Quel r√©sultat final visez-vous ?", 'finalRenderingLabel': ""}, 

    { 'uniqueName': "progress", 'type': "qa", 'priorQuestion': "üèóÔ∏è Votre Projet a t-il d√©j√† avanc√© ?", 'questionFr': "Quel est le travail d√©j√† effectu√© ?", 'finalRenderingLabel': "Quel est l'avancement du Projet ?"},

    { 'uniqueName': "websites", 'type': "websites", 'priorQuestion': "üåê Avez-vous d√©j√† un site web ou un r√©seau social en lien avec votre Projet ?", 'questionFr': "", 'repeatableMessage': 'Voulez-vous ajouter un autre site web ?', 'finalRenderingLabel': ""},

    { 'uniqueName': "places", 'type': "places", 'priorQuestion': "üåç Votre Projet est-il reli√© √† un pays, un d√©partement, ou une ville ?", 'questionFr': "", 'finalRenderingLabel': ""},
    
    { 'uniqueName': "needs", 'type': "needs", 'priorQuestion': "üôÉ Souhaitez-vous de l'aide ?", 'questionFr': "", 'repeatableMessage': 'Voulez-vous ajouter un autre besoin ?', 'finalRenderingLabel': ""}, 
    
    { 'uniqueName': "logo", 'type': "logo", 'priorQuestion': "üçã Avez-vous d√©j√† un logo pour votre projet ?", 'questionFr': "",'finalRenderingLabel': ""}, 

    { 'uniqueName': "imageSlide", 'type': "imageSlide", 'priorQuestion': "üñºÔ∏è Avez-vous une image ou une photo pour illustrer votre projet ?", 'questionFr': "",'finalRenderingLabel': "", 'repeatableMessage': 'Voulez-vous ajouter une autre image ?'},
    
    { 'uniqueName': "categories_keywords", 'type': "categories_keywords", 'questionFr': "Derni√®re √©tape ! Facilitez la d√©couverte de votre Projet üòç"},

] %}

{# For another form...

    { 'uniqueName': "idea", 'type': "qa", 'questionFr': "Comment est n√©e l'id√©e du projet ?", 'finalRenderingLabel': "Comment est n√©e l'id√©e du projet ?"}, 
#}


{% set currentItem = helperItems[position] %}

{% set uniqueName = currentItem.uniqueName %}

{% set currentPosition = position %}

{% set nextPosition = null %}

{% set itemsCount = helperItems | length %}

{% set progressionPercentage = ( (currentPosition + 1) / itemsCount ) * 100 %}

{% if helperItems[position + 1] is defined %}

    {% set nextPosition = position + 1 %}

{% endif %}

{% set nextItem = null %}

    {% if helperItems[position + 1] is defined %}

        {% set nextItem = helperItems[position + 1] %}

    {% endif %}

{% set previousPosition = null %}

    {% if helperItems[position - 1] is defined %}

        {% set previousPosition = position - 1 %}

    {% endif %}


{% block body %}

    {% set hasPriorQuestion = currentItem.priorQuestion is defined %}

        
    <div class="container page-container mt-5" data-track-view='{"key":"pres-help-step-{{ currentPosition }}", "attributes":{"uniqueName": "{{uniqueName}}"} }'>

        {% if currentPosition + 1 != itemsCount %}<h4 class="text-center sm-fs-4 mb-3">‚è±Ô∏è La construction de la pr√©sentation progresse !</h4>{% endif %}

        <div class="progress container col-md-6 px-0 mb-5" role="progressbar" aria-valuenow="{{progressionPercentage}}" aria-valuemin="0" aria-valuemax="100" style="height: 20px">
            <div class="progress-bar" style="width: {{ progressionPercentage }}%">{{ progressionPercentage | round(0, 'floor') }} %</div>
        </div>

        {% include "presentation_helper/_template.html.twig" %}

        {# sometimes we ask user whether he would like an item #}

        {% if currentItem.repeatableMessage is defined %}

            {% include "presentation_helper/_ask_to_repeat.html.twig" %}

        {% endif %}

        {# Quit presentation helper #}

        <div class="text-end text-center text-info mt-4 mt-md-5"><a href="{{ path('show_presentation', {'stringId': stringId}) }}">Quitter le mode pas √† pas</a></div>

    </div>

    


    <style>

        .hide-me{

            display: none;

        }                

        @media screen and (max-width: 580px) {

            .page-container{

                padding-left: 0px;
                padding-right: 0px;
                padding-top: 40px;

            }

            .fs-4{
                font-size: 19px !important;
            }

            .sm-fs-4{
                font-size: 16px;
            }

        }

    </style>

    <script>

        $(document).ready(function(){

            // Giving focus to appropriate input

            function giveFocus(){

                var itemType = $('#presentation_helper_helperItemType').val();
                var relatedInputId;

                switch(itemType) {

                    case 'title':
                        relatedInputId = 'presentation_helper_title';
                        break;
                        
                    case 'qa':
                    case 'textDescription':
                    
                        relatedInputId = 'presentation_helper_answer';
                        break;
                        
                    case 'websites':
                        relatedInputId = 'presentation_helper_url';
                        break;
                        
                    case 'needs':
                        relatedInputId = 'presentation_helper_needTitle';
                        break;
                      
                    default:
                        document.getElementById('autocomplete').focus();  // it is an isolated case, see _form.html.twig
                } 

                $("#"+relatedInputId).focus();
            }

            //alert($('#presentation_helper_nextPosition').val());

            $('#accept-invitation').click(function() {

                $('.hide-me').show();

                $('.invitation-title').hide();
                $('#invitation-container').hide();

                $('.form').show();

                giveFocus(); // form was hiden so we have to give it focus again. 

            });

        });

    </script>

{% endblock %}
